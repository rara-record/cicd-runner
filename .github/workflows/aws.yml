name: TEST CI/CD

on:
  push:
    branches:
      - main

# env:
#   ECR_REGISTRY: ${{ secrets.ECR_REGISTRY_URI }}
#   ECR_REPOSITORY: ${{ secrets.ECR_REPOSITORY_NAME }}
#   IMAGE_TAG: ${{ github.sha }}


jobs:  
  build: 
    name: CI
    runs-on: ubuntu-latest

    steps:
    - name: Checkout 
      uses: actions/checkout@v2 

    - name: test-build
      run: echo "test-build"

    # - name: Configure AWS credentials 
    #   uses: aws-actions/configure-aws-credentials@v1 
    #   with:
    #     aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
    #     aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
    #     aws-region: ap-northeast-2

    # - name: Login to Amazon ECR 
    #   id: login-ecr
    #   uses: aws-actions/amazon-ecr-login@v1 

    # - name: Build, tag, and push image to Amazon ECR
    #   id: build-image
    #   run: |
    #     docker build -t ${{ env.ECR_REGISTRY }}/${{ env.ECR_REPOSITORY }}:${{ env.IMAGE_TAG }} .
    #     docker push ${{ env.ECR_REGISTRY }}/${{ env.ECR_REPOSITORY }}:${{ env.IMAGE_TAG }}

  deploy:
    needs: build 
    name: CD
    runs-on: [self-hosted, test-runner]
    
    steps:
    - name: test-deploy
      run: echo "test-deploy.."
